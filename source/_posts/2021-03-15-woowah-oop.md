---
layout: post
title:  "우아한 객체지향"
date:   2021-03-15 00:0054 +0900
categories: java
---

객체지향에서 설계에 대해서 굉장히 중요한 것은 의존성이다.

설계라는 것은 -> 코드를 어떻게 배치할 것에 대한 의사결정.
어떤 패키지에 어떤 코드를 넣을거고, 어떤 프로젝트에 어떤 코드를 넣을거고.. 이런 것들.

초점은 변경에 맞춰야한다. 같이 변경되는 코드는 함께두어야하고 그렇지 않으면 따로둬야한다.
이 변경이라는 것이 결국은 의존성.

A -------> B
A가 B에 의존되고 있다 = B가 변경되면 A도 변경될 가능성이 있다.

의존성은 변경과 관련된 것.

Class 사이의 Dependancy

Package 사이의 Dependancy

두가지로 나뉜다.

클래스 의존성 종류.

연관관계 (Association) -> A에서 B로 영구적으로 갈 수 있는 것
```java
class A {
    private B b;
}
```

의존관계 (Dependency) -> 일시적으로 관계를 맺는 것.
```java
class A {
    public B method(B b) {
        return new B();
    }
}
```

상속관계 (Inheritance) -> 구현이 바뀌더라도 영향을 받는다.
```java
class A extends B {
}
```

실체화 관계 -> 인터페이스가 구현된것
```java
class A implements B {
}
```

설계를 할때 좋은 의존성을 관리하는 규칙

1. 양방향 의존성을 피하라 (순환참조 관계)
```java
/** BAD */
class A {
    private B b;

    public void setA(B b) {
        this.b = b;
        this.b.setA(this);
    }
}

class B {
    private A a;
    
    public void setA(A a) {
        this. a = a;
    }
}
```

```java
/** GOOD */ 
class A {
    private B b;

    public void setA(B b) {
        this.b = b;
    }
}

class B {
}
```

만약 정말 이렇게 구현된 객체가 있다면 이것은 한 클래스로도 만들 수 있음에도 억지로 찢어 놓은 걸 수도 있다.

2. 다중성이 적은 방향을 선택하라.

```java
/** BAD */
class A {
    private Collection<B> bs;
}

class B {
}
```

```java
/** GOOD */
class A {
}

class B {
    private A a;
}
```

3. 의존성이 필요없다면 제거하라.

패키지 사이의 의존성 사이클을 제거하라.

설계에서 가장 중요한건 변경.
의존성이 사이클이 돈다는 이야기는 -> 원래 하나의 패키지로 볼수도 있음을 고려해야함.

시스템은 엄청 동적인것이지만 이걸 구현하는 코드는 정적인 것.

정적인 이 코드로 동적인 시스템을 구현하기 위해선 시스템이 가진 정적인 특징들을 잘 잡아쟈한다.

첫번째 클래스 다이어그램ㅇ르 그리고 이 클래스 끼리의 관계라고 하는것. 의존성이라고 하는 걸 잘 고려하자.
의존성은 방향성이 존재.

디비의 릴레이션은 외래키 잡으면 방향성이 없음

관계의 방향 -> 협력의 방향 -> 의존성의 방향
시스템상에서 실제로 플로우가 어떻게 흐르느냐에 따라서 그걸 따라서 클래스 다이어그램을 만들고, 관계를 그려야한다. 즉 의존성을 만들어내야 한다.


클래스 다이어그램을 그리라 -> 협력의 방향을 상상해라 -> 의존성을 잡아라.

이 의존성을 표현하는 방법은 4가지 아까 위에서 언급함.

(1) 연관관계 (객체참조)
협력을 위해 필요한 영구적 탐색 구조.
실제적으로는 데이터에 영향을 받지만 우선은 잡는다.

(2) 의존관계 (파라미터, 리턴타입, 지연변수)
협력을 위해 일시적으로 필요한 의존성.

협력을 해야하는 이유, 의존성을 가져야 하는 이유를 항상 생각하라.

연관관계는 개념적인것. 이를 구현하기 위해 객체참조. 이 개념을 구현하기 위한 방법이 여러가지가 있음.
대표적인 방법은 객체참조.



